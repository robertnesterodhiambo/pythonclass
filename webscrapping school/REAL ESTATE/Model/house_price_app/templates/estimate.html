{% extends "base.html" %}
{% block title %}Estimate - House Price App{% endblock %}

{% block content %}
<div class="grid">
  <!-- Form Card -->
  <div class="card">
    <h2>Enter Property Details</h2>
    <form method="post" action="{{ url_for('estimate') }}">
      <label>Bedrooms
        <input type="number" name="bed" required min="0" value="{{ request.form.bed or (user.beds if user) or '' }}">
      </label>

      <label>Bathrooms
        <input type="number" name="bath" required min="0" value="{{ request.form.bath or (user.baths if user) or '' }}">
      </label>

      <label>House size (sqft)
        <input type="number" step="0.1" name="house_size" required value="{{ request.form.house_size or (user.sqft if user) or '' }}">
      </label>

      <label>Lot size (acres)
        <input type="number" step="0.01" name="acre_lot" required value="{{ request.form.acre_lot or (user.lot_size if user) or '' }}">
      </label>

      <label>City/County
        <input type="text" name="city" value="{{ request.form.city or (user.county if user) or '' }}">
      </label>

      <label>State
        <input type="text" name="state" value="{{ request.form.state or '' }}">
      </label>

      <label>Zip code
        <input type="text" name="zip_code" value="{{ request.form.zip_code or '' }}">
      </label>

      <label>Status (for_sale / sold / pending)
        <input type="text" name="status" value="{{ request.form.status or '' }}">
      </label>

      <button type="submit">Get Estimate</button>
    </form>
  </div>

  <!-- Result + User Data -->
  <div class="card">
    {% if price %}
    <div style="margin-bottom:20px;">
      <h2>Predicted Price</h2>
      <p style="font-size:1.6rem; font-weight:600; color:var(--apple-blue);">
        ${{ "{:,.2f}".format(price) }}
      </p>
    </div>
    {% endif %}

    {% if user %}
    <h2>Your Saved Property</h2>
    <p><b>Address:</b> {{ user.property_address or '—' }}</p>
    <p><b>Beds:</b> {{ user.beds or '—' }} &nbsp; <b>Baths:</b> {{ user.baths or '—' }}</p>
    <p><b>SqFt:</b> {{ user.sqft or '—' }} &nbsp; <b>Lot:</b> {{ user.lot_size or '—' }}</p>
    <p><b>Year Built:</b> {{ user.year_built or '—' }}</p>
    <p><b>County:</b> {{ user.county or '—' }}</p>

    <hr>
    <p><b>Stored Estimated Value (from signup):</b>
       {% if user.estimated_value %}${{ "{:,.2f}".format(user.estimated_value) }}{% else %}—{% endif %}
    </p>

    {% if price and user.estimated_value %}
    <hr>
    <h3>Comparison</h3>
    <p><b>Predicted now:</b> ${{ "{:,.2f}".format(price) }}</p>
    <p><b>Stored estimate:</b> ${{ "{:,.2f}".format(user.estimated_value) }}</p>
    <p><b>Difference:</b>
       ${{ "{:,.2f}".format(price - user.estimated_value) }}
    </p>
    {% endif %}
    {% endif %}
  </div>
</div>
{% endblock %}
